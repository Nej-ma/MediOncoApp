{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport React, { createContext, useContext, useState, useEffect } from 'react';\nimport * as AuthService from \"../features/authentication/services/authService\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport var AuthContext = createContext();\nexport var AuthProvider = function AuthProvider(_ref) {\n  var children = _ref.children;\n  var _useState = useState(null),\n    _useState2 = _slicedToArray(_useState, 2),\n    user = _useState2[0],\n    setUser = _useState2[1];\n  var _useState3 = useState(false),\n    _useState4 = _slicedToArray(_useState3, 2),\n    isLoggedIn = _useState4[0],\n    setIsLoggedIn = _useState4[1];\n  var _useState5 = useState(true),\n    _useState6 = _slicedToArray(_useState5, 2),\n    loading = _useState6[0],\n    setLoading = _useState6[1];\n  var _useState7 = useState(''),\n    _useState8 = _slicedToArray(_useState7, 2),\n    loginError = _useState8[0],\n    setLoginError = _useState8[1];\n  useEffect(function () {\n    var checkAuthStatus = function () {\n      var _ref2 = _asyncToGenerator(function* () {\n        var token = yield AuthService.verifyToken();\n        setIsLoggedIn(token !== false);\n        if (token) {\n          var userInfo = yield AuthService.getStoredUserInfo();\n          if (userInfo) {\n            setUser(userInfo);\n          }\n        } else {\n          setUser(null);\n          setIsLoggedIn(false);\n        }\n        setLoading(false);\n      });\n      return function checkAuthStatus() {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n    checkAuthStatus();\n  }, []);\n  var login = function () {\n    var _ref3 = _asyncToGenerator(function* (username, password) {\n      setLoading(true);\n      try {\n        var authResponse = yield AuthService.authenticate(username, password);\n        if (authResponse.success) {\n          var userInfo = yield AuthService.getUserInfo(authResponse.token);\n          setUser(userInfo);\n          setIsLoggedIn(true);\n          setLoginError('');\n        } else {\n          setIsLoggedIn(false);\n          setLoginError(authResponse.message || 'Login failed');\n        }\n      } catch (error) {\n        console.error('Error during login:', error);\n        setIsLoggedIn(false);\n        setLoginError('Login failed due to an error');\n      }\n      setLoading(false);\n    });\n    return function login(_x, _x2) {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n  var logout = function () {\n    var _ref4 = _asyncToGenerator(function* () {\n      yield AuthService.logout();\n      setUser(null);\n      setIsLoggedIn(false);\n      setLoginError('');\n    });\n    return function logout() {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n  var changePassword = function () {\n    var _ref5 = _asyncToGenerator(function* (userId, currentPassword, newPassword) {\n      console.log(\"changePassword\", userId, currentPassword, newPassword);\n      try {\n        var response = yield AuthService.changePassword(userId, currentPassword, newPassword);\n        console.log(\"response\", response);\n        if (response.success) {\n          return true;\n        } else {\n          return false;\n        }\n      } catch (error) {\n        console.error('Error changing password:', error);\n        return false;\n      }\n    });\n    return function changePassword(_x3, _x4, _x5) {\n      return _ref5.apply(this, arguments);\n    };\n  }();\n  return _jsx(AuthContext.Provider, {\n    value: {\n      user: user,\n      isLoggedIn: isLoggedIn,\n      login: login,\n      logout: logout,\n      loading: loading,\n      loginError: loginError,\n      changePassword: changePassword\n    },\n    children: children\n  });\n};\nexport var useAuthContext = function useAuthContext() {\n  return useContext(AuthContext);\n};","map":{"version":3,"names":["React","createContext","useContext","useState","useEffect","AuthService","jsx","_jsx","AuthContext","AuthProvider","_ref","children","_useState","_useState2","_slicedToArray","user","setUser","_useState3","_useState4","isLoggedIn","setIsLoggedIn","_useState5","_useState6","loading","setLoading","_useState7","_useState8","loginError","setLoginError","checkAuthStatus","_ref2","_asyncToGenerator","token","verifyToken","userInfo","getStoredUserInfo","apply","arguments","login","_ref3","username","password","authResponse","authenticate","success","getUserInfo","message","error","console","_x","_x2","logout","_ref4","changePassword","_ref5","userId","currentPassword","newPassword","log","response","_x3","_x4","_x5","Provider","value","useAuthContext"],"sources":["C:/Users/littl/Desktop/saeapp/frontend/src/context/authContext.js"],"sourcesContent":["import React, { createContext, useContext, useState, useEffect } from 'react';\r\nimport * as AuthService from '../features/authentication/services/authService'; // Adjust the import path as needed\r\n\r\nexport const AuthContext = createContext();\r\n\r\nexport const AuthProvider = ({ children }) => {\r\n    const [user, setUser] = useState(null);\r\n    const [isLoggedIn, setIsLoggedIn] = useState(false);\r\n    const [loading, setLoading] = useState(true);\r\n    const [loginError, setLoginError] = useState('');\r\n\r\n    useEffect(() => {\r\n        const checkAuthStatus = async () => {\r\n            const token = await AuthService.verifyToken();\r\n            setIsLoggedIn(token !== false);\r\n    \r\n            if (token) {\r\n                const userInfo = await AuthService.getStoredUserInfo();\r\n                if (userInfo) {\r\n                    setUser(userInfo);\r\n                }\r\n            } else {\r\n                setUser(null);\r\n                setIsLoggedIn(false);\r\n            }\r\n    \r\n            setLoading(false);\r\n        };\r\n    \r\n        checkAuthStatus();\r\n    }, []);\r\n    \r\n\r\n    const login = async (username, password) => {\r\n        setLoading(true);\r\n        try {\r\n            const authResponse = await AuthService.authenticate(username, password);\r\n            if (authResponse.success) {\r\n                const userInfo = await AuthService.getUserInfo(authResponse.token);\r\n                setUser(userInfo);\r\n                setIsLoggedIn(true);\r\n                setLoginError('');\r\n            } else {\r\n                setIsLoggedIn(false);\r\n                setLoginError(authResponse.message || 'Login failed');\r\n            }\r\n        } catch (error) {\r\n            console.error('Error during login:', error);\r\n            setIsLoggedIn(false);\r\n            setLoginError('Login failed due to an error');\r\n        }\r\n        setLoading(false);\r\n    };\r\n\r\n    const logout = async () => {\r\n        await AuthService.logout();\r\n        setUser(null);\r\n        setIsLoggedIn(false);\r\n        setLoginError('');\r\n    };\r\n\r\n    const changePassword = async (userId, currentPassword, newPassword) => {\r\n        console.log(\"changePassword\",userId, currentPassword, newPassword);\r\n        try {\r\n          const response = await AuthService.changePassword(userId, currentPassword, newPassword);\r\n          console.log(\"response\",response);\r\n          if (response.success) {\r\n            // Optionally update local user state or perform other actions as needed\r\n            return true;\r\n          } else {\r\n            return false;\r\n          }\r\n        } catch (error) {\r\n          console.error('Error changing password:', error);\r\n          return false;\r\n        }\r\n      };\r\n      \r\n\r\n    return (\r\n        <AuthContext.Provider value={{ user, isLoggedIn, login, logout, loading, loginError, changePassword }}>\r\n            {children}\r\n        </AuthContext.Provider>\r\n    );\r\n};\r\n\r\nexport const useAuthContext = () => useContext(AuthContext);\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}